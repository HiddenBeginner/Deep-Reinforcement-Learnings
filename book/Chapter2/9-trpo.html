
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>14. Trust Region Policy Optimization (TRPO) &#8212; ì‹¬ì¸µê°•í™”í•™ìŠµ</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "HiddenBeginner/Deep-Reinforcement-Learnings");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ğŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../_static/HDBG.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15. TRPO êµ¬í˜„" href="10-implementation-trpo.html" />
    <link rel="prev" title="13. Generalized Advantage Estimation (GAE)" href="8-gae.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FTQEC31PV8"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-FTQEC31PV8');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/HDBG.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ì‹¬ì¸µê°•í™”í•™ìŠµ</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ì‹¬ì¸µê°•í™”í•™ìŠµ (Deep Reinforcement Learnings)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Markov Decision Process
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1/1-sequential-decision-making-problems.html">
   1. ìˆœì°¨ì  ì˜ì‚¬ ê²°ì • ë¬¸ì œ, ì—ì´ì „íŠ¸, í™˜ê²½
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1/2-markov-decision-processes.html">
   2. Markov Decision Process (MDP)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1/3-policy-return-value.html">
   3. ì •ì±…, Return, ê°€ì¹˜ í•¨ìˆ˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1/4-bellman-equation.html">
   4. ë²¨ë§Œ ë°©ì •ì‹: ê°€ì¹˜ í•¨ìˆ˜ì˜ ì¬ê·€ì  ì„±ì§ˆ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1/5-stochastic-approximation.html">
   5. ê°€ì¹˜ í•¨ìˆ˜ ê·¼ì‚¬í•˜ê¸°: Stochastic approximation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Policy gradient methods
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1-policy-gradient-theorem.html">
   6. Policy Gradient Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2-reinforce.html">
   7. REINFORCE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-implementation-reinforce.html">
   8. REINFORCE êµ¬í˜„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4-reinforce-with-baseline.html">
   9. REINFORCE with baseline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5-actor-critic.html">
   10. Actor-critic ì•Œê³ ë¦¬ì¦˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6-implementation-actor-critic.html">
   11. Online/batch actor-critic êµ¬í˜„
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7-n_step-actor-critic.html">
   12.
   <span class="math notranslate nohighlight">
    \(n\)
   </span>
   -step return actor-critic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8-gae.html">
   13. Generalized Advantage Estimation (GAE)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   14. Trust Region Policy Optimization (TRPO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10-implementation-trpo.html">
   15. TRPO êµ¬í˜„
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ì°¸ê³ ë¬¸í—Œ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Reference.html">
   ì°¸ê³ ë¬¸í—Œ
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/hiddenbeginner/Deep-Reinforcement-Learnings"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/hiddenbeginner/Deep-Reinforcement-Learnings/issues/new?title=Issue%20on%20page%20%2Fbook/Chapter2/9-trpo.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/book/Chapter2/9-trpo.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservative-policy-iteration-cpi">
   14.1. Conservative policy iteration (CPI)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     14.1.1. ì‚¬ìš©í•  í‘œê¸°ë“¤
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     14.1.2. ë‘ ì •ì±…ì˜ ì„±ëŠ¥ ì‚¬ì´ì˜ ê´€ê³„ì‹
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     14.1.3. ì‹
     <span class="math notranslate nohighlight">
      \((1)\)
     </span>
     ì— ëŒ€í•œ ê·¼ì‚¬
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eta-l-lower-bound">
     14.1.4. ì •ì±…ì´ ì•„ì£¼ ì¡°ê¸ˆ ë³€í•  ë•Œ,
     <span class="math notranslate nohighlight">
      \(\eta\)
     </span>
     ì™€
     <span class="math notranslate nohighlight">
      \(L\)
     </span>
     ì˜ ì°¨ì´ì˜ lower bound
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   14.2. ë³´ë‹¤ ì¼ë°˜ì ì¸ ì •ì±…ìœ¼ë¡œì˜ í™•ì¥
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trust-region-policy-optimization">
   14.3. Trust Region Policy Optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-based-estimation-of-the-objective-and-constraint">
   14.4. Sample-based Estimation of the Objective and Constraint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   14.5. Experiments
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Trust Region Policy Optimization (TRPO)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservative-policy-iteration-cpi">
   14.1. Conservative policy iteration (CPI)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     14.1.1. ì‚¬ìš©í•  í‘œê¸°ë“¤
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     14.1.2. ë‘ ì •ì±…ì˜ ì„±ëŠ¥ ì‚¬ì´ì˜ ê´€ê³„ì‹
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     14.1.3. ì‹
     <span class="math notranslate nohighlight">
      \((1)\)
     </span>
     ì— ëŒ€í•œ ê·¼ì‚¬
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eta-l-lower-bound">
     14.1.4. ì •ì±…ì´ ì•„ì£¼ ì¡°ê¸ˆ ë³€í•  ë•Œ,
     <span class="math notranslate nohighlight">
      \(\eta\)
     </span>
     ì™€
     <span class="math notranslate nohighlight">
      \(L\)
     </span>
     ì˜ ì°¨ì´ì˜ lower bound
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   14.2. ë³´ë‹¤ ì¼ë°˜ì ì¸ ì •ì±…ìœ¼ë¡œì˜ í™•ì¥
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trust-region-policy-optimization">
   14.3. Trust Region Policy Optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-based-estimation-of-the-objective-and-constraint">
   14.4. Sample-based Estimation of the Objective and Constraint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   14.5. Experiments
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="trust-region-policy-optimization-trpo">
<h1><span class="section-number">14. </span>Trust Region Policy Optimization (TRPO)<a class="headerlink" href="#trust-region-policy-optimization-trpo" title="Permalink to this headline">#</a></h1>
<p>ì´ë²ˆ ì¥ì—ì„œëŠ” Trust Region Policy Optimization (TRPO)ì˜ ì´ë¡ ì ì¸ ë‚´ìš©ì— ëŒ€í•´ì„œ ì†Œê°œí•  ì˜ˆì •ì´ë‹¤.
Policy gradientëŠ” í˜„ì¬ íŒŒë¼ë¯¸í„° <span class="math notranslate nohighlight">\(\theta\)</span>ì—ì„œ ëª©ì í•¨ìˆ˜ <span class="math notranslate nohighlight">\(J(\theta)\)</span>ê°€ ê°€ì¥ ê°€íŒŒë¥´ê²Œ ë°©í–¥ì„ ì•Œë ¤ì£¼ì§€ë§Œ, í•´ë‹¹ ë°©í–¥ìœ¼ë¡œ ì–¼ë§ˆë‚˜ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ëŠ”ì§€ëŠ” ì•Œë ¤ì£¼ì§€ ì•ŠëŠ”ë‹¤.
ë”°ë¼ì„œ policy gradient ì¶”ì •ê°’ì„ ì‚¬ìš©í•´ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ ì‹¤ì œë¡œ ì •ì±…ì˜ ì„±ëŠ¥ì´ ì¦ê°€í•  ìˆ˜ë„ ìˆê³  ì˜¤íˆë ¤ ë°˜ëŒ€ë¡œ ê°ì†Œí•  ìˆ˜ë„ ìˆë‹¤.
TRPO ë…¼ë¬¸ì€ ì •ì±…ì˜ ì„±ëŠ¥ í–¥ìƒì´ ë³´ì¥ë˜ëŠ” íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ ì˜ì—­ì„ ì´ë¡ ì ìœ¼ë¡œ ì´ëŒì–´ ë‚´ëŠ” ë…¼ë¬¸ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.
íŠ¹íˆ, ì‚¬ì „ ì—°êµ¬ì¸ conservative policy iteration (CPI) ë…¼ë¬¸ì„ ê°œì„ í•˜ëŠ” ì—°êµ¬ì´ê¸° ë•Œë¬¸ì— CPIë¥¼ ë¨¼ì € ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.</p>
<br>
<hr class="docutils" />
<section id="conservative-policy-iteration-cpi">
<h2><span class="section-number">14.1. </span>Conservative policy iteration (CPI)<a class="headerlink" href="#conservative-policy-iteration-cpi" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3><span class="section-number">14.1.1. </span>ì‚¬ìš©í•  í‘œê¸°ë“¤<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>ìš°ì„  ì‚¬ì „ ì—°êµ¬ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  í‘œê¸°ë“¤ì„ ì •ì˜í•˜ë„ë¡ í•˜ê² ë‹¤. ìš°ë¦¬ê°€ í’€ê³  ì‹¶ì€ ìˆœì°¨ì  ì˜ì‚¬ ê²°ì • ë¬¸ì œëŠ” <span class="math notranslate nohighlight">\(MDP( \mathcal{S}, \mathcal{A}, p, r, d_0, \gamma)\)</span>ë¡œ ëª¨ë¸ë§í•  ê²ƒì´ë‹¤. ì´ë•Œ, <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>ëŠ” ìƒíƒœ ê³µê°„, <span class="math notranslate nohighlight">\(\mathcal{A}\)</span>ëŠ” í–‰ë™ ê³µê°„, <span class="math notranslate nohighlight">\(p:\mathcal{S} \times \mathcal{A} \times \mathcal{S} \rightarrow [0,1]\)</span>ëŠ” ì „ì´í™•ë¥ ë¶„í¬, <span class="math notranslate nohighlight">\(r: \mathcal{S} \rightarrow \mathbb{R}\)</span> ì€ ë³´ìƒí•¨ìˆ˜ <span class="math notranslate nohighlight">\(d_0: \mathcal{S} \rightarrow [0,1]\)</span> ì€ ì´ˆê¸° ìƒíƒœì˜ í™•ë¥ ë¶„í¬, <span class="math notranslate nohighlight">\(\gamma\)</span>ëŠ” í• ì¸ë¥ ì´ë‹¤.</p>
<br>
<p>ì •ì±… <span class="math notranslate nohighlight">\(\pi: \mathcal{S} \times \mathcal{A} \rightarrow [0,1]\)</span> ì€ ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì—ì„œ í–‰ë™ <span class="math notranslate nohighlight">\(a\)</span>ë¥¼ ì·¨í•  í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤. ìš°ë¦¬ëŠ” ëˆ„ì í• ì¸ë³´ìƒì˜ ê¸°ëŒ“ê°’ì„ ìµœëŒ€ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ì •ì±…ì„ ì°¾ê³  ì‹¶ë‹¤. ì£¼ì–´ì§„ ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span> ì˜ ëˆ„ì í• ì¸ë³´ìƒì˜ ê¸°ëŒ“ê°’ì„ ë‹¤ìŒê³¼ ê°™ì´ ì ì–´ì¤„ ìˆ˜ ìˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\eta(\pi)=\mathbb{E}_{s_0,a_0,s_1,a_1, \cdots}\left[ \sum\limits_{t=0}^{\infty} \gamma^t r(s_t)\right], \text{where} \\
s_0 \sim d_0, \; a_t \sim \pi(a_t|s_t), \; s_{t+1} \sim p(s_{t+1}|s_t, a_t).
\end{matrix}
\end{split}\]</div>
<br>
<p>ìœ„ ìˆ˜ì‹ì´ ëˆ„ì í• ì¸ë³´ìƒì˜ ê¸°ëŒ“ê°’ì„ ì»´íŒ©íŠ¸í•˜ê²Œ ì˜ ë‚˜íƒ€ë‚¸ ê²ƒ ê°™ë‹¤. ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span> ì˜ ì´ˆê¸° ìƒíƒœì˜ ìƒíƒœê°€ì¹˜í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ì´ê¸°ë„ í•˜ë‹¤.</p>
<br>
<p>í•œí¸, ì£¼ì–´ì§„ ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ì˜ ìƒíƒœê°€ì¹˜í•¨ìˆ˜ <span class="math notranslate nohighlight">\(V^{\pi}:\mathcal{S}\rightarrow\mathbb{R}\)</span>, í–‰ë™ê°€ì¹˜í•¨ìˆ˜ <span class="math notranslate nohighlight">\(Q^{\pi}:\mathcal{S}\times \mathcal{A} \rightarrow\mathbb{R}\)</span>, ê·¸ë¦¬ê³  advantage í•¨ìˆ˜ <span class="math notranslate nohighlight">\(A^{\pi}: \mathcal{S} \times \mathcal{A} \rightarrow \mathbb{R}\)</span>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
V^{\pi}(s_t) = \mathbb{E}_{a_t, s_{t+1}, a_{t+1}, \cdots} \left[ \sum\limits_{l=0}^{\infty} \gamma^{l} r(s_{t+1})\right], \\
Q^{\pi}({s_t, a_t}) = \mathbb{E}_{s_{t+1}, a_{t+1}, \cdots} \left[ \sum\limits_{l=0}^{\infty} \gamma^{l} r(s_{t+1})\right], \\
A^{\pi}(s_t, a_t) = Q^{\pi}(s_t, a_t) - V^{\pi}(s_t), \text{ where } \\
a_t \sim \pi(a_t | s_t), \; s_{t+1} \sim p(s_{t+1}|s_{t}, a_{t}) \text{ for } t\ge0.
\end{matrix}
\end{split}\]</div>
<br>
</section>
<hr class="docutils" />
<section id="id2">
<h3><span class="section-number">14.1.2. </span>ë‘ ì •ì±…ì˜ ì„±ëŠ¥ ì‚¬ì´ì˜ ê´€ê³„ì‹<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>ì§€ê¸ˆê¹Œì§€ëŠ” ëª¨ë‘ ìµìˆ™í•œ ê°œë…ì¼ ê²ƒì´ë‹¤. ì•ìœ¼ë¡œ ë‚˜ì˜¬ ê°œë…ì€ ë‹¤ì†Œ ìƒì†Œí•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì •ì±…ì˜ monotonic improvementì´ë‹¤. ì •ì±…ì˜ ì„±ëŠ¥ì´ í–¥ìƒë˜ì—ˆëŠ”ì§€ ì•Œê¸° ìœ„í•´ì„œëŠ” <span class="math notranslate nohighlight">\(\eta({\pi_{\text{new}}})\)</span> ì™€ <span class="math notranslate nohighlight">\(\eta(\pi_{\text{old}})\)</span> ë¥¼ ê°ê° êµ¬í•´ì„œ ë¹„êµí•˜ë©´ ë  ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ë‘˜ ë‹¤ êµ¬í•˜ëŠ” ëŒ€ì‹  <span class="math notranslate nohighlight">\(\eta({\pi_{\text{new}}})\)</span>ì™€ <span class="math notranslate nohighlight">\(\eta(\pi_{\text{old}})\)</span>ì˜ ê´€ê³„ì‹ì„ êµ¬í•  ê²ƒì´ë‹¤. ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ ì•„ë¬´ ë‘ ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ì™€ <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ì´ ì£¼ì–´ì¡Œì„ ë•Œ, ì •ì±… <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ì˜ ì„±ëŠ¥ì§€í‘œë¥¼ <span class="math notranslate nohighlight">\(\pi\)</span>ì˜ ì„±ëŠ¥ì§€í‘œì— ëŒ€í•œ ê´€ê³„ì‹ìœ¼ë¡œ ì ì–´ì¤„ ìˆ˜ ìˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[
\eta(\tilde{\pi})=\eta(\pi) + \mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t} A^{\pi}(s_t, a_t) \right], \quad \quad (1)
\]</div>
<br>
<p>ì—¬ê¸°ì„œ <span class="math notranslate nohighlight">\(\tau \sim \tilde{\pi}\)</span>ëŠ” <span class="math notranslate nohighlight">\(\tau = (s_0, a_0, s_1, a_1, \cdots)\)</span>ì¸ë° <span class="math notranslate nohighlight">\(s_0 \sim d_0\)</span> ì´ë©° <span class="math notranslate nohighlight">\(a_t \sim \tilde{\pi}(a_t | s_t)\)</span>ì´ë‹¤. <span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ëŠ” <span class="math notranslate nohighlight">\(\eta({\pi})\)</span> ë”í•˜ê¸° <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ë¡œ trajectoryë¥¼ ë§Œë“¤ ë•Œ ë§Œë“¤ì–´ì§€ëŠ” ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ì˜ advantage í•¨ìˆ˜ê°’ì˜ ê¸°ëŒ“ê°’ì´ë‹¤. í•„ìì˜ ì–¸ì–´ë¡œ ì •ë¦¬í•˜ìë©´,</p>
<ul class="simple">
<li><p>í˜„ì¬ ì£¼ì–´ì§„ ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span> ì— ëŒ€í•´ì„œ ìš°ë¦¬ëŠ” <span class="math notranslate nohighlight">\(\eta({\pi})\)</span>ì™€ <span class="math notranslate nohighlight">\(A^{\pi}\)</span>ë¥¼ ì•Œê³  ìˆëŠ” ìƒí™©ì´ë‹¤.</p></li>
<li><p>ìš°ë¦¬ëŠ” ë‹¤ë¥¸ ì •ì±… <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span> ì˜ <span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ë¥¼ ì§ì ‘ ê³„ì‚°í•˜ì§€ ì•Šê³  <span class="math notranslate nohighlight">\(\eta({\pi})\)</span>ì™€ <span class="math notranslate nohighlight">\(A^{\pi}\)</span>ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ê²ƒì´ë‹¤.</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ì€ <span class="math notranslate nohighlight">\(\eta({\pi})\)</span>ì—ì„œ <span class="math notranslate nohighlight">\(\pi\)</span> ëŒ€ì‹  <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ë¡œ trajectoryë¥¼ ë½‘ì•˜ì„ ë•Œ ì–»ê²Œ ë˜ëŠ” ì´ìµì˜ ê¸°ëŒ“ê°’ì„ ë”í•´ì¤€ ê°’ì´ë‹¤.</p></li>
<li><p>ì°¸ê³ ë¡œ <span class="math notranslate nohighlight">\(\pi\)</span>ë¡œ í–‰ë™ì„ ë½‘ì•˜ì„ ë•Œ <span class="math notranslate nohighlight">\(\mathbb{E}_{a_t \sim \pi(a_t | s_t)} \left[ A^{\pi}(s_t, a_t) \right]=0\)</span> ì¸ ê²ƒì„ ìƒê°í•˜ë©´ , <span class="math notranslate nohighlight">\(\mathbb{E}_{a_t \sim \tilde{\pi}(a_t | s_t)} \left[ A^{\pi}(s_t, a_t) \right]\)</span>ê°€ <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span> ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ ì–»ê²Œ ë˜ëŠ” ì¶”ê°€ ì´ë“ì¸ ê²ƒì„ ë°›ì•„ë“¤ì´ê¸° ì‰½ë‹¤.</p></li>
</ul>
<br>
<p>ì—¬ì „íˆ ë°›ì•„ë“¤ì´ê¸° ì–´ë ¤ìš´ í¬ì¸íŠ¸ê°€ ìˆì„ ìˆ˜ ìˆë‹¤. ë•Œë¡œëŠ” ì§ê´€ì ì¸ ì„¤ëª…ë³´ë‹¤ ì‹ìœ¼ë¡œ ì§ì ‘ ì¦ëª…í•˜ëŠ”ê²Œ ì´í•´ì— ë„ì›€ì„ ì¤„ ìˆ˜ ìˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t} A^{\pi}(s_t, a_t) \right] &amp; = &amp; \mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t} \left(Q^{\pi}(s_t, a_t) - V^{\pi}(s_t)\right) \right] &amp; \quad (a) \\
&amp; = &amp; \mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t} \left(r(s_t) + \gamma V^{\pi}(s_{t+1}) - V^{\pi}(s_t)\right) \right] &amp; \quad (b) \\
&amp; = &amp; 
\mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t}r(s_t) \right] - \mathbb{E}_{\tau \sim \tilde{\pi}} \left[ V^{\pi}(s_0) \right] &amp; \quad (c) \\
&amp; = &amp; \eta(\tilde{\pi}) - \eta(\pi) &amp; \quad (d)
\end{matrix}
\end{split}\]</div>
<br>
<p>ìš°ì„  <span class="math notranslate nohighlight">\((a)\)</span> ëŠ” advantange í•¨ìˆ˜ì˜ ì •ì˜ <span class="math notranslate nohighlight">\(A^{\pi}(s_t, a_t) = Q^{\pi}(s_t, a_t) - V^{\pi}(s_t)\)</span>ë¥¼ ëŒ€ì…í•œ ê²ƒì´ë‹¤. ë‹¤ìŒìœ¼ë¡œ <span class="math notranslate nohighlight">\((b)\)</span> ëŠ” í–‰ë™ê°€ì¹˜í•¨ìˆ˜ì— ëŒ€í•œ ë‹¤ìŒ ë²¨ë§Œë°©ì •ì‹ì„ ëŒ€ì…í•œ ê²ƒì´ë‹¤.</p>
<div class="math notranslate nohighlight">
\[
Q^{\pi}(s_t, a_t) = r(s_t) + \gamma\mathbb{E}_{s_{t+1}\sim P(s_{t+1}|s_t, a_t)}\left[ V^{\pi}(s_{t+1})\right]
\]</div>
<br>
<p>ìœ„ë¥¼ ëŒ€ì…í•˜ë©´ ê¸°ëŒ“ê°’ ì•ˆì—ì„œ ê¸°ëŒ“ê°’ì´ ë“±ì¥í•˜ëŠ”ë°, <a class="reference external" href="https://en.wikipedia.org/wiki/Law_of_total_expectation">Law of total expectation</a>ì— ì˜í•´ ê¸°ëŒ“ê°’ ì•ˆì˜ ê°’ì€ ì§€ì›Œì§ˆ ìˆ˜ ìˆë‹¤. <a class="reference external" href="https://en.wikipedia.org/wiki/Law_of_total_expectation">Law of total expectation</a>ëŠ” ê¸°ëŒ“ê°’ ì•ˆì˜ ê¸°ëŒ“ê°’ì€ ë” ì´ìƒ í™•ë¥  ë³€ìˆ˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ì¼ì´ë‹¤. ë‚´ë¶€ ê¸°ëŒ“ê°’ì„ ê³„ì‚°í•˜ëŠ”ë° í™•ë¥  ë³€ìˆ˜ê°€ ì†Œì§„ë˜ì–´ ë²„ë¦°ë‹¤ë„ê¹Œ?</p>
<br>
<p>ì‹ <span class="math notranslate nohighlight">\((c)\)</span> ëŠ” ì‹œê·¸ë§ˆë¥¼ ì „ê°œí•œ ê²ƒì´ë‹¤. <span class="math notranslate nohighlight">\(r(s_t)\)</span> ë“¤ì„ ë‹¤ ëª¨ì•„ë†“ì•„ì„œ <span class="math notranslate nohighlight">\(\mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t}r(s_t) \right]\)</span> ê°€ ë˜ê³ , ë‚˜ë¨¸ì§€ëŠ” <span class="math notranslate nohighlight">\(V^{\pi}(s_0)\)</span>ë§Œ ì œì™¸í•˜ê³  ë‹¤ ì†Œê±°ëœë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹ <span class="math notranslate nohighlight">\((d)\)</span> ì˜ ì²« ë²ˆì§¸ í…€ì€ <span class="math notranslate nohighlight">\(\eta\)</span> í•¨ìˆ˜ì˜ ì •ì˜ì— ì˜í•œ ê²ƒì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((c)\)</span> ì˜ ë‘ ë²ˆì§¸ ê¸°ëŒ“ê°’ ì•ˆì—ì„œ í™•ë¥  ë³€ìˆ˜ëŠ” <span class="math notranslate nohighlight">\(s_0\)</span> ë°–ì— ì—†ë‹¤. ë”°ë¼ì„œ <span class="math notranslate nohighlight">\(\tau \sim \tilde{\pi}\)</span> ì—ì„œ ë‚˜ë¨¸ì§€ í™•ë¥ ë³€ìˆ˜ëŠ” ì‚¬ìš©ë˜ì§€ ì•Šê³  <span class="math notranslate nohighlight">\(s_0\)</span> ë§Œ ê¸°ëŒ“ê°’ ê³„ì‚°ì— ê´€ì—¬í•  ìˆ˜ ìˆë‹¤. <span class="math notranslate nohighlight">\(s_0\)</span>ëŠ” ì •ì±…ê³¼ ìƒê´€ ì—†ì´ <span class="math notranslate nohighlight">\(d_0\)</span> ì—ë§Œ ê²°ì •ëœë‹¤. ì¦‰, ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ì˜ ì´ˆê¸° ìƒíƒœì˜ ìƒíƒœê°€ì¹˜í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ ì¦‰, <span class="math notranslate nohighlight">\(\eta(\pi)\)</span>ì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((d)\)</span> ë¥¼ ì •ë¦¬í•˜ë©´ ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤ <span class="math notranslate nohighlight">\(\Box\)</span>.</p>
<br>
</section>
<hr class="docutils" />
<section id="id3">
<h3><span class="section-number">14.1.3. </span>ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì— ëŒ€í•œ ê·¼ì‚¬<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>ì—¬ì „íˆ í’€ë¦¬ì§€ ì•ŠëŠ” ë¯¸ìŠ¤í…Œë¦¬. ì •ì±… <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span> ì˜ <span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ë¥¼ ì§ì ‘ ê³„ì‚°í•˜ì§€ ì•Šê³  <span class="math notranslate nohighlight">\(\eta({\pi})\)</span>ì™€ <span class="math notranslate nohighlight">\(A^{\pi}\)</span>ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•˜ê³  ì‹¶ì€ë°, ì € ê¸°ëŒ“ê°’ì˜ <span class="math notranslate nohighlight">\(\tau \sim \tilde{\pi}\)</span> ì´ê±¸ í•˜ê¸° ìœ„í•´ì„œëŠ” ì¼ë‹¨ ì •ì±…ì´ ì¢‹ë“  ë‚˜ì˜ë“  trajectoryë¥¼ ë§Œë“¤ì–´ë´ì•¼ í•œë‹¤. êµ‰ì¥íˆ ë¹„íš¨ìœ¨ì ì´ë‹¤. ìš°ë¦¬ëŠ” <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ë¥¼ ì§ì ‘ ì‹œí–‰í•´ë³´ì§€ ì•Šê³ ë„ <span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ë¥¼ ê³„ì‚°í•˜ê³  ì‹¶ë‹¤.</p>
<br>
<p>Conservative policy improvement (CPI) ë…¼ë¬¸ì—ì„œëŠ” ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ì§ì ‘ êµ¬í•˜ëŠ” ê²ƒì„ í¬ê¸°í–ˆë‹¤. ëŒ€ì‹ ì— ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ê·¼ì‚¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ê³¼ ê·¼ì‚¬í–ˆì„ ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ì˜ lower boundë¥¼ ì œì‹œí•˜ì˜€ë‹¤. ë“¤ì–´ê°€ê¸°ì— ì•ì„œ í•œ ê°€ì§€ í‘œê¸°ë¥¼ ë” ì •ì˜í•˜ê³  ê°€ì. ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ë¥¼ ë”°ëì„ ë•Œ ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì— ìˆì„ í™•ë¥  ë¶„í¬ì˜ discounted ë²„ì „ìœ¼ë¡œ ìƒê°í•˜ë©´ ëœë‹¤. ì±…ì—ì„œëŠ” unnormalized discounted visitations frequencies ë¼ê³  ëª…ëª…í•˜ì˜€ë‹¤. <span class="math notranslate nohighlight">\(d_{\pi}: \mathcal{S} \rightarrow \mathbb{R}\)</span>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[
d_{\pi}(s) = P(s_0=s) + \gamma P(s_1=s) + \gamma^{2}  P(s_2=s) +\cdots, \quad \quad (*)
\]</div>
<br>
<p>ì´ë•Œ <span class="math notranslate nohighlight">\(s_0 \sim d_0\)</span>ì´ê³ , ë‚˜ë¨¸ì§€ëŠ” ì •ì±… <span class="math notranslate nohighlight">\(\pi\)</span>ë¥¼ ë”°ëì„ ë•Œ ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì— ë„ì°©í•  í™•ë¥ ì´ë‹¤. í•´ì„í•˜ìë©´, ê° ì‹œì ì—ì„œ ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì— ìˆì„ í™•ë¥ ì— í• ì¸ë¥ ì„ ì ìš©í•´ì¤€ ê²ƒì´ë‹¤. <span class="math notranslate nohighlight">\(\gamma\)</span>ê°€ 1ì´ë¼ë©´ stationary distribution ëŠë‚Œì´ ë‚˜ê¸°ë„ í•œë‹¤. ì—„ë°€íˆ ë§í•˜ë©´ ëª¨ë“  <span class="math notranslate nohighlight">\(s\)</span>ì— ëŒ€í•´ì„œ <span class="math notranslate nohighlight">\(d_\pi(s)\)</span>ë¥¼ ë”í–ˆì„ ë•Œ 1ì´ ë„˜ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í™•ë¥ ë¶„í¬ê°€ ë  ìˆ˜ ì—†ë‹¤. ê·¸ë˜ì„œ â€œunnormalizedâ€, â€œvisitation frequencyâ€ë¼ê³  ë¶€ë¥´ëŠ” ê²ƒì´ë‹¤. ì°¸ê³ ë¡œ ìš°ë³€ì— <span class="math notranslate nohighlight">\(\frac{1}{1-\gamma}\)</span>ë¥¼ ê³±í•´ì£¼ë©´ í™•ë¥ ë¶„í¬ê°€ ë  ìˆ˜ ìˆë‹¤. Stationary distributionë„ ì•„ë‹Œ ì‹ <span class="math notranslate nohighlight">\((*)\)</span>ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ê·¸ëƒ¥ ë‚˜ì¤‘ì— ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë¹„ì¤‘ì€ ë‚®ìœ¼ë‹ˆ í˜¼ë€ìŠ¤ëŸ¬ìš°ë©´ ë°›ì•„ë“¤ì´ê³  ë„˜ì–´ê°€ì!</p>
<br>
<p>ë‹¤ìŒìœ¼ë¡œ ë¬¸ì œê°€ ë˜ëŠ” ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ê¸°ëŒ“ê°’ì˜ ì •ì˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì‹œ ì ì–´ë³´ì. í‘œê¸°ì˜ í¸ì˜ì„±ì„ ìœ„í•´ ì´ì‚° ìƒíƒœ/í–‰ë™ ê³µê°„ì„ ê°€ì •í•˜ì—¬ ì‹œê·¸ë§ˆ í‘œê¸°ë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ, ì—°ì† ê³µê°„ì˜ ê²½ìš° ì¸í…Œê·¸ë„ í‘œê¸°ë¥¼ ì‚¬ìš©í•´ë„ ë˜‘ê°™ì€ ê²°ê³¼ë¥¼ ì–»ê²Œëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\eta(\tilde{\pi}) &amp; = &amp; \eta(\pi) + \mathbb{E}_{\tau \sim \tilde{\pi}} \left[ \sum\limits_{t=0}^{\infty} \gamma^{t} A^{\pi}(s_t, a_t) \right] &amp; \quad (a) \\
&amp; = &amp; \eta(\pi) + \sum\limits_{t}^{\infty}\sum\limits_{s}P(s_t=s | \tilde{\pi})\sum\limits_{a}\tilde{\pi}(a | s)\gamma^{t} A^{\pi}(s, a) &amp; \quad (b) \\
&amp; = &amp; \eta(\pi) + \sum\limits_{s}\sum\limits_{t=0}^{\infty}\gamma^t P(s_t=s | \tilde{\pi})\sum\limits_{a}\tilde{\pi}(a|s) A^{\pi}(s, a) &amp; \quad (c) \\
&amp; = &amp; \eta(\pi) + \sum\limits_{s}d_{\tilde{\pi}}(s)\sum\limits_{a}\tilde{\pi}(a|s) A^{\pi}(s, a). &amp; \quad(d)
\end{matrix}, \quad \quad (2)
\end{split}\]</div>
<br>
<p>ì‹ <span class="math notranslate nohighlight">\((a)\)</span>ëŠ” ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((b)\)</span>ì€ ê¸°ëŒ“ê°’ì˜ ì •ì˜ë¥¼ ì‚¬ìš©í•œ ê²ƒì´ë‹¤. êµ³ì´ ë””í…Œì¼í•˜ê²Œ ì„¤ëª…í•˜ìë©´ ë¨¼ì € ê¸°ëŒ“ê°’ì˜ ì„ í˜•ì„±ì„ ì´ìš©í•˜ì—¬ <span class="math notranslate nohighlight">\(\sum\limits_{t=0}^{\infty}\)</span>ë¥¼ ê¸°ëŒ“ê°’ ë°”ê¹¥ìœ¼ë¡œ ë¹¼ì¤€ ê²ƒì´ê³ , ê° ì‹œì  <span class="math notranslate nohighlight">\(t\)</span>ì—ì„œ ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì¼ í™•ë¥ ê³¼ í–‰ë™ <span class="math notranslate nohighlight">\(a\)</span>ì¼ í™•ë¥ ì„ ê³ ë ¤í•´ì„œ <span class="math notranslate nohighlight">\(\gamma^{t} A^{\pi}(s, a)\)</span>ì˜ ê¸°ëŒ“ê°’ì„ ê³„ì‚°í•˜ëŠ” ê²ƒì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((c)\)</span>ëŠ” ì‹œê·¸ë§ˆì˜ ìˆœì„œì™€ <span class="math notranslate nohighlight">\(\gamma^{t}\)</span>ì˜ ìˆœì„œë¥¼ ë°”ê¿”ì¤€ ê²ƒì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((d)\)</span>ëŠ” ì‹ <span class="math notranslate nohighlight">\((*)\)</span>ë¥¼ ëŒ€ì…í•´ì¤€ ê²ƒì´ë‹¤.</p>
<br>
<p>ìš°ë¦¬ì˜ ê±±ì •ì€ ì •ì±…ì´ ì¢‹ë“  ë‚˜ì˜ë“  <span class="math notranslate nohighlight">\(\tau \sim \tilde{\pi}\)</span>ë¥¼ í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤. í•˜ì§€ë§Œ ì‹ <span class="math notranslate nohighlight">\((2)\)</span>ì„ ë³´ë‹ˆ ì–´ë–¤ ë¶€ë¶„ì´ ë¬¸ì œì¸ì§€ ì¡°ê¸ˆ ë” ì˜ ë³´ì¸ë‹¤. ì •ì±… <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ì„ í¬í•¨í•˜ê³  ìˆëŠ” ë¶€ë¶„ì€ <span class="math notranslate nohighlight">\(d(\tilde{\pi})\)</span>ì™€ <span class="math notranslate nohighlight">\(\tilde{\pi}(a|s)\)</span>ì´ë‹¤. ì‚¬ì‹¤ <span class="math notranslate nohighlight">\(\tilde{\pi}(a|s)\)</span>ëŠ” í° ë¬¸ì œê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì •ì±…ì„ ë§¤ê°œë³€ìˆ˜í™”ëœ í•¨ìˆ˜ë¡œ ëª¨ë¸ë§í•˜ë©´ <span class="math notranslate nohighlight">\(\tilde{\pi}(a|s)\)</span>ëŠ” ì‰½ê²Œ ê³„ì‚°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ <span class="math notranslate nohighlight">\(d(\tilde{\pi})\)</span>ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì„ ë¶ˆê°€ëŠ¥ì— ê°€ê¹ë‹¤. ë”°ë¼ì„œ CPI ë…¼ë¬¸ì—ì„œëŠ” <span class="math notranslate nohighlight">\(d(\tilde{\pi})\)</span> ëŒ€ì‹  <span class="math notranslate nohighlight">\(d(\pi)\)</span>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ê·¼ì‚¬í•˜ê²Œ ëœë‹¤. ì¦‰,</p>
<div class="math notranslate nohighlight">
\[
\eta(\tilde{\pi})\approx L_{\pi}(\tilde{\pi}) :=\eta(\pi) + \sum\limits_{s}d_{\pi}(s)\sum\limits_{a}\tilde{\pi}(a|s) A^{\pi}(s, a). \quad \quad (3)
\]</div>
<br>
<p>ì°¸ê³ ë¡œ <span class="math notranslate nohighlight">\(L_{\pi}(\pi)\)</span>ëŠ” advantage functionì˜ ê¸°ëŒ“ê°’ì¸ 0ì´ ë˜ê¸° ë•Œë¬¸ì— <span class="math notranslate nohighlight">\(\eta(\pi)\)</span>ì´ë‹¤. ë³¸ì¸ì˜ ì„±ëŠ¥ì„ ë³¸ì¸ì˜ ì„±ëŠ¥ìœ¼ë¡œ í‘œí˜„í•´ì•¼ í•˜ë‹ˆ ë‹¹ì—°ì´ ê°™ì„ ìˆ˜ ë°–ì— ì—†ê¸´ í•˜ë‹¤. ë¹„ë¡ ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì— ëŒ€í•œ approximation ì´ì§€ë§Œ ìµœì†Œí•œì˜ ì„±ì§ˆì€ ë§Œì¡±í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë§Œì•½ ìš°ë¦¬ê°€ ë§¤ê°œë³€ìˆ˜í™”ëœ ì •ì±… <span class="math notranslate nohighlight">\(\pi_\theta\)</span>ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë§¤ê°œë³€ìˆ˜ê°€ <span class="math notranslate nohighlight">\(\theta_0\)</span>ì¼ ë•Œ ë‹¤ìŒì´ ì„±ë¦½í•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
L_{\pi_{\theta_0}}(\pi_{\theta
_0}) &amp; =  &amp; \eta(\pi_{\theta_0}), \; \text{ so that} &amp; \\
\nabla_{\theta}L_{\pi_{\theta_0}}(\pi_{\theta})|_{\theta=\theta_0} &amp; = &amp; \nabla_{\theta}\eta(\pi_\theta)|_{\theta=\theta_0} . &amp; \quad (4) 
\end{matrix} 
\end{split}\]</div>
<br>
<p>ë„ˆë¬´ë‚˜ë„ ë‹¹ì—°í•œ ì´ì•¼ê¸°ì´ë‹¤. ì‹ <span class="math notranslate nohighlight">\((4)\)</span>ì—ì„œ ìƒê°í•´ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì€ <span class="math notranslate nohighlight">\(\pi_{\theta_0}\)</span>ì—ì„œ ì—…ë°ì´íŠ¸ë¥¼ ì•„ì£¼ ì¡°ê¸ˆë§Œ í•´ì„œ <span class="math notranslate nohighlight">\(\tilde{\pi}\)</span>ë¥¼ ë§Œë“¤ì–´ëƒˆì„ ë•Œ, approximationì¸ <span class="math notranslate nohighlight">\(L_{\pi_{\theta}}\)</span>ë¥¼ ê°œì„ í•˜ë©´ ê³§ ì‹¤ì œ <span class="math notranslate nohighlight">\(\eta\)</span>ê°€ ê°œì„ ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì •ì±… ì—…ë°ì´íŠ¸ë¥¼ ì–¼ë§ˆë‚˜ ì¡°ê¸ˆ í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ê¸°ì¤€ì´ ì—†ë‹¤.</p>
<br>
</section>
<hr class="docutils" />
<section id="eta-l-lower-bound">
<h3><span class="section-number">14.1.4. </span>ì •ì±…ì´ ì•„ì£¼ ì¡°ê¸ˆ ë³€í•  ë•Œ, <span class="math notranslate nohighlight">\(\eta\)</span>ì™€ <span class="math notranslate nohighlight">\(L\)</span>ì˜ ì°¨ì´ì˜ lower bound<a class="headerlink" href="#eta-l-lower-bound" title="Permalink to this headline">#</a></h3>
<p>CPI ë…¼ë¬¸ì—ì„œëŠ” ì •ì±…ì´ ì•„ì£¼ ì¡°ê¸ˆ ë°”ë€Œë„ë¡ ìƒí™©ì—ì„œ <span class="math notranslate nohighlight">\(\eta(\tilde{\pi})\)</span>ì™€ <span class="math notranslate nohighlight">\(L_{\pi}(\tilde{\pi})\)</span>ì˜ ì°¨ì´ì˜ lower boundë¥¼ ì°¾ì•„ëƒˆë‹¤. â€œì •ì±…ì´ ì•„ì£¼ ì¡°ê¸ˆ ë°”ë€ŒëŠ” ìƒí™©â€ì„ ìœ„í•´ CPI ë…¼ë¬¸ì—ì„œëŠ” ë‹¤ìŒ mixture policyë¥¼ ê³ ë ¤í•˜ê²Œ ëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[
\pi_{\text{new}}(a|s) = (1-\alpha)\pi_{\text{old}}(a|s) + \alpha\pi'(a|s), \quad \quad (5)
\]</div>
<br>
<p>ì´ë•Œ, <span class="math notranslate nohighlight">\(0\le \alpha \le 1\)</span> ì´ê³  <span class="math notranslate nohighlight">\(\pi' = \operatorname{argmax}_{\pi'}L_{\pi_{\text{old}}}(\pi')\)</span>ì´ë‹¤. ì–´ë–»ê²Œ êµ¬í•˜ëŠ”ì§€ëŠ” ëª¨ë¥´ì§€ë§Œ êµ¬í–ˆë‹¤ê³  ìƒê°í•˜ê³  ì„¤ëª…ì„ ê³„ì†í•˜ë„ë¡ í•˜ê² ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ì˜ ë¯¿ìŒì€ <span class="math notranslate nohighlight">\(L_{\pi_{\text{old}}}(\pi')\)</span>ì´ í° <span class="math notranslate nohighlight">\(\eta(\pi')\)</span>ë„ í´ ê²ƒì´ë¼ëŠ” ê²ƒì´ê³ , ì‚¬ì‹¤ ì´ ë¯¿ìŒì€ ì—ì„œ ì—…ë°ì´íŠ¸ í¬ê¸°ê°€ ì‘ì„ìˆ˜ë¡  ë” ì‹ ë¢°ë„ê°€ ì˜¬ë¼ê°€ê¸° ë•Œë¬¸ì— <span class="math notranslate nohighlight">\(\pi_{\text{old}}\)</span>ì™€ <span class="math notranslate nohighlight">\(\pi'\)</span>ë¥¼ ì„ì–´ì„œ <span class="math notranslate nohighlight">\(\pi_{\text{new}}\)</span>ë¥¼ ë§Œë“œëŠ” ê²ƒì´ë‹¤.</p>
<br>
<p>ì´ëŸ° <span class="math notranslate nohighlight">\(\pi_{\text{new}}\)</span>ì— ëŒ€í•´ì„œ ì‹¤ì œ <span class="math notranslate nohighlight">\(\eta(\pi_{\text{new}})\)</span>ì™€ ê·¼ì‚¬ì¹˜ <span class="math notranslate nohighlight">\(L_{\pi_{\text{old}}}(\pi_{\text{new}})\)</span>ì˜ ê´€ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\eta(\pi_{\text{new}}) \ge L_{\pi_{\text{old}}}(\pi_{\text{new}}) - \frac{2\epsilon\gamma}{(1-\gamma)^2}\alpha^2, \; \text{where} \\
\epsilon = \max\limits_{s}\left|\mathbb{E}_{a \sim \pi'(a|s)} \left[ A^{\pi_{\text{new}}}(s,a)\right] \right|. \quad\quad(6)
\end{matrix}
\end{split}\]</div>
<br>
<p>ë¶€ë“±ì‹ì˜ ìš°ë³€ì—ì„œ <span class="math notranslate nohighlight">\(\frac{2\gamma}{(1-\gamma)^2}\alpha^2\)</span>ì€ ìƒìˆ˜ì´ê¸° ë•Œë¬¸ì— <span class="math notranslate nohighlight">\(\epsilon\)</span>ë§Œ ì‚´í´ë³´ì. Advantage í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ì€ 0ì´ë¼ëŠ” ê²ƒì„ ì—¼ë‘í•˜ë©´, <span class="math notranslate nohighlight">\(\pi'\)</span>ê°€ <span class="math notranslate nohighlight">\(\pi_{\text{new}}\)</span>ì™€ ë‹¤ë¥´ë©´ ë‹¤ë¥¼ìˆ˜ë¡ <span class="math notranslate nohighlight">\(\epsilon\)</span>ì´ ì»¤ì§€ê²Œ ëœë‹¤. ë”°ë¼ì„œ <span class="math notranslate nohighlight">\(\pi'\)</span>ì™€ <span class="math notranslate nohighlight">\(\pi_{\text{new}}\)</span>ê°€ ë¹„ìŠ·í•˜ë©´ <span class="math notranslate nohighlight">\(\frac{2\epsilon\gamma}{(1-\gamma)^2}\alpha^2\)</span>ì´ 0ì— ê°€ê¹Œì›Œì§€ê³ , <span class="math notranslate nohighlight">\(\pi' = \pi_{\text{new}}\)</span>ì´ë©´ ì‹ <span class="math notranslate nohighlight">\((4)\)</span>ì—ì„œ ë´¤ë˜ ê²ƒì²˜ëŸ¼ ë“±í˜¸ê°€ ì„±ë¦½í•˜ê²Œ ëœë‹¤. ì‹ <span class="math notranslate nohighlight">\((6)\)</span> ë¶€ë“±ì‹ ì¦ëª…ì´ ìƒê°ë³´ë‹¤ ì–´ë µì§€ ì•Šë‹¤. ë‹¤ë§Œ, ë¶„ëŸ‰ì„ ê³ ë ¤í•´ì„œ ì´ ê¸€ì—ì„œ ì¦ëª…ì€ ìƒëµí•˜ê±°ë‚˜, ë‚˜ì˜ í˜ì´ ë‚¨ì•„ìˆë‹¤ë©´ ê¸€ì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì— ë‚¨ê²¨ë†“ë„ë¡ í•˜ê² ë‹¤.</p>
<br>
<p>ì‹ <span class="math notranslate nohighlight">\((6)\)</span>ì—ì„œ ì–»ì–´ê°€ì•¼í•  ê°€ì¥ í° ì¸ì‚¬ì´íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul class="simple">
<li><p>í˜„ì¬ ì •ì±… <span class="math notranslate nohighlight">\(\pi_{\text{old}}\)</span>ì— ëŒ€í•´ì„œ ì •ì±… ì—…ë°ì´íŠ¸ê°€ ì—†ëŠ” ê²½ìš°  ë¶€ë“±ì‹ <span class="math notranslate nohighlight">\((6)\)</span>ì˜ ë“±í˜¸ê°€ ì„±ë¦½í•œë‹¤. ì¦‰,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\eta(\pi_{\text{new}})=L_{\pi_{\text{old}}}(\pi_{\text{new}}) - \frac{2\epsilon\gamma}{(1-\gamma)^2}\alpha^2, \; {\text{ where }} \;\pi_{\text{new}} = \pi_{\text{old}}.
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\pi_{\text{new}} = \pi_{\text{old}}\)</span>ì¼ ë•Œë³´ë‹¤ ë” ë†’ì€ <span class="math notranslate nohighlight">\(L_{\pi_{\text{old}}}(\pi_{\text{new}}) - \frac{2\epsilon\gamma}{(1-\gamma)^2}\alpha^2\)</span>ë¥¼ ê°–ëŠ” <span class="math notranslate nohighlight">\(\pi_{\text{new}}\)</span>ë¥¼ ì°¾ì•„ë‚¸ë‹¤ëŠ” ê²ƒì˜ ì˜ë¯¸ëŠ”</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta(\pi_{\text{new}})\)</span>ê°€ <span class="math notranslate nohighlight">\(\eta(\pi_{\text{old}})\)</span>ë³´ë‹¤ ë” ë†’ì€ lower boundë¥¼ ê°–ê¸° ë•Œë¬¸ì— ë” ì„±ëŠ¥ì´ ì¢‹ë‹¤ëŠ” ê²ƒì´ë‹¤.</p></li>
</ul>
<br>
<p>ë”°ë¼ì„œ lower boundì¸ <span class="math notranslate nohighlight">\(L_{\pi_{\text{old}}}(\pi_{\text{new}}) - \frac{2\epsilon\gamma}{(1-\gamma)^2}\alpha^2\)</span>ë¥¼ ì»¤ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ ì •ì±…ì„ ì—…ë°ì´íŠ¸í•  ê²½ìš° monotonic improvementê°€ ëœë‹¤ëŠ” ê²ƒì´ë‹¤.</p>
<br>
<p>ì—¬ê¸°ê¹Œì§€ê°€ ë…¼ë¬¸ì˜ ì‚¬ì „ì§€ì‹ (preliminaries)ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. ì •ë¦¬í•˜ìë©´,</p>
<ul class="simple">
<li><p>í•œ ì •ì±…ì˜ ì„±ëŠ¥ì„ ë‹¤ë¥¸ ì •ì±…ìœ¼ë¡œ í‘œí˜„í•˜ê¸° â†’ ì‹ <span class="math notranslate nohighlight">\((1)\)</span></p></li>
<li><p>ì‹ <span class="math notranslate nohighlight">\((1)\)</span>ì„ ê·¼ì‚¬í•˜ëŠ” ë°©ë²•ê³¼ ê·¼ì‚¬ ì˜¤ì°¨ì˜ lower bound â†’ ì‹ <span class="math notranslate nohighlight">\((3), (6)\)</span></p></li>
<li><p>í˜„ì¬ ì •ì±…ë³´ë‹¤ ë” ë†’ì€ lower boundë¥¼ ê°–ëŠ” ì •ì±…ì„ ì°¾ìœ¼ë©´ ì‹¤ì œ ì„±ëŠ¥ì§€í‘œ <span class="math notranslate nohighlight">\(\eta\)</span>ë„ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— monotonic improvementê°€ ë³´ì¥ëœë‹¤.</p></li>
</ul>
<br>
<p>TRPO ë…¼ë¬¸ì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ì˜ ê³¼ì •ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ê°€ì¥ í•µì‹¬ì ì¸ ê²ƒ ê°™ë‹¤. ìœ„ ê³¼ì •ë§Œ ì´í•´í•˜ê³  ìˆë‹¤ë©´, TRPOê°€ CPIì˜ ì–´ë–¤ ë¶€ë¶„ì„ ì–´ë–»ê²Œ ê°œì„ ì„ í•˜ëŠ”ì§€ê°€ ì˜ ë³´ì´ê²Œ ëœë‹¤.</p>
<br>
</section>
</section>
<hr class="docutils" />
<section id="id4">
<h2><span class="section-number">14.2. </span>ë³´ë‹¤ ì¼ë°˜ì ì¸ ì •ì±…ìœ¼ë¡œì˜ í™•ì¥<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<p>ì´ì œë¶€í„° TRPO ë…¼ë¬¸ì˜ contributionì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. í•˜ì§€ë§Œ ì•„ì§ TRPO ë‚´ìš©ì€ ì•„ë‹ˆë‹¤. CPIë¥¼ ë¨¼ì € ì¼ë°˜ì ì¸ ì •ì±… ì—…ë°ì´íŠ¸ì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì´ë¡ ì ì¸ ê°œì„ ì„ í•˜ê³ , ê·¸ ê°œì„ ì²´ì˜ êµ¬í˜„ ë²„ì „ì´ ë°”ë¡œ TRPOì´ë‹¤.</p>
<br>
<p>CPIì˜ ê°€ì¥ í° ë¬¸ì œì ì€ ì‹ <span class="math notranslate nohighlight">\((5)\)</span>ì™€ ê°™ì€ mixture policyì— ëŒ€í•´ì„œ ì´ë¡ ì´ ê¸°ìˆ ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤. í•˜ì§€ë§Œ ë§ì€ ê³³ì—ì„œ mixture policyë¥¼ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. TRPO ë…¼ë¬¸ì—ì„œëŠ” ì‹ <span class="math notranslate nohighlight">\((6)\)</span>ì˜ ê²°ë¡ ì„  ì¼ë°˜ì ì¸ stochastic policyì— ëŒ€í•´ì„œ í™•ì¥í•˜ì˜€ë‹¤.</p>
<br>
<p>ìš°ë¦¬ëŠ” ì‹ <span class="math notranslate nohighlight">\((6)\)</span>ì˜ lower boundë¥¼ ì¦ê°€ì‹œí‚¤ì§€ë§Œ, ê·¸ë ‡ë‹¤ê³  ì´ì „ ì •ì±…ê³¼ëŠ” ë„ˆë¬´ ë‹¬ë¼ì§€ì§€ ì•Šê²Œ í•˜ê¸° ìœ„í•˜ì—¬ mixture policyë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ì—¬ê¸°ì„œ ì–´ë–¤ ì ì„ ê°œì„ í•  ìˆ˜ ìˆì„ê¹Œ? Lower boundëŠ” ì¦ê°€ì‹œí‚¤ëŠ” ê²ƒì€ ë™ì¼í•˜ë˜, ì´ì „ ì •ì±…ê³¼ ê°€ê¹Œìš´ ì •ì±…ì„ ì–´ë–»ê²Œ ì •ì˜í•  ê²ƒì¸ì§€ë¥¼ ë°”ê¿”ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ë”°ë¼ì„œ TRPO ë…¼ë¬¸ì—ì„œëŠ” ì •ì±…ê³¼ ì •ì±… ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•˜ì—¬ the total variation divergence (TV)ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ë‘ í™•ë¥ ë¶„í¬ <span class="math notranslate nohighlight">\(p\)</span>ì™€ <span class="math notranslate nohighlight">\(q\)</span>ì˜ TVëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[
D_{\text{TV}}(p \Vert q) = \frac{1}{2}\sum_i |p_i - q_i|.
\]</div>
<br>
<p>ìœ„ëŠ” ì„ì˜ì˜ í™•ë¥ ë¶„í¬ <span class="math notranslate nohighlight">\(p\)</span>ì™€ <span class="math notranslate nohighlight">\(q\)</span>ì˜ TV ê±°ë¦¬ì´ë‹¤. TRPOì—ì„œëŠ” ë‘ ì •ì±… ì‚¬ì´ì˜ TV ê±°ë¦¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í–ˆë‹¤.</p>
<div class="math notranslate nohighlight">
\[
D_{\text{TV}}^{\text{max}}(\pi, \tilde{\pi})=\max\limits_{s}D_{\text{TV}}(\pi(\cdot | s) \Vert \tilde{\pi}(\cdot | s)). \quad \quad (7)
\]</div>
<br>
<p>ê° ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì—ì„œ ê³„ì‚°í•œ ë‘ ì •ì±…ì˜ TV ê±°ë¦¬ ì¤‘ì—ì„œ ê°€ì¥ í° ê°’ì„ ë‘ ì •ì±…ì˜ TV ê±°ë¦¬ë¼ê³  ì •ì˜í•œ ê²ƒì´ë‹¤. TRPO ë…¼ë¬¸ì—ì„œëŠ” <span class="math notranslate nohighlight">\(\alpha = D_{\text{TV}}^{\text{max}}(\pi, \tilde{\pi})\)</span>ë¡œ ì„¤ì •í•  ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ ë¶€ë“±ì‹ì´ ì„±ë¦½í•¨ì„ ë³´ì˜€ë‹¤.</p>
<div class="math notranslate nohighlight">
\[
\eta(\pi_{\text{new}}) \ge L_{\pi_{\text{old}}}(\pi_{\text{new}}) - \frac{4\epsilon\gamma}{(1-\gamma)^2}\alpha^2, \; {\text{ where }} \;\epsilon = \max\limits_{s, a} |A^{\pi}(s, a)|. \quad \quad (8)
\]</div>
<br>
<p>í˜„ì¬ ì •ì±… <span class="math notranslate nohighlight">\(\pi_{\text{old}}\)</span>ì™€ TV ê±°ë¦¬ <span class="math notranslate nohighlight">\(\alpha\)</span>ë§Œí¼ ë–¨ì–´ì§„ ì •ì±…ë“¤ì— ëŒ€í•´ì„œ ì‹ <span class="math notranslate nohighlight">\((8)\)</span>ì˜ ë¶€ë“±ì‹ì´ ì„±ë¦½í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ CPIì™€ ê°™ì€ ë…¼ë¦¬ë¥¼ ì ìš©í•´ë³´ì. í˜„ì¬ ì •ì±…ë³´ë‹¤ lower boundê°€ ë†’ìœ¼ë©´ì„œ, í˜„ì¬ ì •ì±…ê³¼ TV ê±°ë¦¬ê°€ <span class="math notranslate nohighlight">\(\alpha\)</span>ë§Œí¼ ë–¨ì–´ì§„ ì •ì±…ì„ ì°¾ìœ¼ë©´ ê·¸ ì •ì±…ì€ monotonically improvedëœ ì •ì±…ì´ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ, parameterized policyë¥¼ ì‚¬ìš©í•  ê²½ìš°, lower boundì˜ gradientë¥¼ ê³„ì‚°í•œ í›„, ê·¸ ë°©í–¥ìœ¼ë¡œ line searchí•˜ë©´ì„œ TV ê±°ë¦¬ê°€ <span class="math notranslate nohighlight">\(\alpha\)</span>ì¸ ì •ì±…ì„ ì°¾ìœ¼ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>
<br>
<p>í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” TV ê±°ë¦¬ë³´ë‹¤ KL ê±°ë¦¬ê°€ ë” ìµìˆ™í•˜ë‹¤. ë”°ë¼ì„œ TRPO ë…¼ë¬¸ì—ì„œëŠ” ë‹¤ìŒì˜ TV ê±°ë¦¬ì™€ KL ê±°ë¦¬ì˜ ê´€ê³„ì‹ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</p>
<div class="math notranslate nohighlight">
\[
D_{\text{TV}}(p \Vert q)^2 \le D_{\text{KL}}(p \Vert q)
\]</div>
<br>
<p>TV ê±°ë¦¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë‘ ì •ì±… ì‚¬ì´ì˜ KL ê±°ë¦¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì.</p>
<div class="math notranslate nohighlight">
\[
D_{\text{KL}}^{\text{max}}(\pi, \tilde{\pi})=\max\limits_{s}D_{\text{KL}}(\pi(\cdot | s) \Vert \tilde{\pi}(\cdot | s)).
\]</div>
<br>
<p>TV ê±°ë¦¬ì˜ ì œê³±ë³´ë‹¤ KL ê±°ë¦¬ì˜ ê°’ì´ ë” í¬ê¸° ë•Œë¬¸ì— ì‹ <span class="math notranslate nohighlight">\((8)\)</span>ì˜ <span class="math notranslate nohighlight">\(\alpha^2\)</span>ì„ KL ê±°ë¦¬ë¡œ ë°”ê¿”ì¤˜ë„ ë¶€ë“±ì‹ì´ ì„±ë¦½í•œë‹¤. ì¦‰,</p>
<div class="math notranslate nohighlight">
\[
\eta(\tilde{\pi}) \ge L_{\pi}(\tilde{\pi}) - C D_{\text{KL}}^{\text{max}}(\pi, \tilde{\pi}), \; {\text{ where }} C=\frac{4\epsilon\gamma}{(1-\gamma)^2}. \quad \quad (9)
\]</div>
<br>
<p>ì´ ì‹ <span class="math notranslate nohighlight">\((9)\)</span>ê°€ TRPO ë…¼ë¬¸ì˜ í•µì‹¬ ì´ë¡ ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. ì´ ë¶€ë“±ì‹ì„ ì´ìš©í•˜ì—¬ ì •ì±…ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒ ê·¸ë¦¼ê³¼ ê°™ë‹¤.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/algorithm.png"><img alt="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/algorithm.png" src="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/algorithm.png" style="width: 500px;" /></a>
</figure>
<br>
<p>Lower boundë¥¼ ìµœëŒ€í™”í•˜ë©´ì„œ ì •ì±…ì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. Lower boundë¥¼ Minorizationë¼ê³  ë¶€ë¥´ê¸°ë„ í•˜ëŠ” ê²ƒ ê°™ë‹¤. ê·¸ë˜ì„œ ìœ„ ì•Œê³ ë¦¬ì¦˜ì„ Minorization-Maximization (MM) ì•Œê³ ë¦¬ì¦˜ì´ë¼ê³  ë¶€ë¥¸ë‹¤. MM ì•Œê³ ë¦¬ì¦˜ ë¶„ì•¼ì—ì„œ ì‹¤ì œ ì„±ëŠ¥ì§€í‘œ <span class="math notranslate nohighlight">\(\eta\)</span> ëŒ€ì‹ ìœ¼ë¡œ ìµœì í™”ë˜ëŠ” ëŒ€ìƒì„ surrogate functionì´ë¼ê³  ë¶€ë¥¸ë‹¤. ë”°ë¼ì„œ lower boundë¥¼ surrogate functionì´ë¼ê³  ë¶€ë¥¸ë‹¤.</p>
<br>
</section>
<hr class="docutils" />
<section id="trust-region-policy-optimization">
<h2><span class="section-number">14.3. </span>Trust Region Policy Optimization<a class="headerlink" href="#trust-region-policy-optimization" title="Permalink to this headline">#</a></h2>
<p>ì§€ê¸ˆê¹Œì§€ëŠ” ì´ë¡ ì ì¸ ì„¤ëª…ì´ì—ˆë‹¤. í•˜ì§€ë§Œ ì´ë¡ ê³¼ êµ¬í˜„ ì‚¬ì´ì—ëŠ” ê´´ë¦¬ê°€ ìˆëŠ” ë²•ì´ë‹¤. ë¨¼ì € ì§€ê¸ˆê¹Œì§€ ì´ë¡  ì „ê°œì—ì„œ ìš°ë¦¬ëŠ” ì •ì±…ì˜ advantage functionì„ ì •í™•íˆ ì•ˆë‹¤ê³  ê°€ì •í–ˆë‹¤. ê·¸ë¦¬ê³  surrogate functionì„ ìµœì í™” í•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í–ˆë‹¤. Surrogate function ì•ˆì—ëŠ” KL ê±°ë¦¬ê°€ ìˆë‹¤. KL ê±°ë¦¬ê°€ <span class="math notranslate nohighlight">\(\alpha\)</span>ì¸ ì •ì±…ì„ ì–´ë–»ê²Œ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œ? ì§€ê¸ˆê¹Œì§€ ì´ë¡ ì„ ë°”íƒ•ìœ¼ë¡œ ì´ë¡ ì„ ê·¼ì‚¬í•˜ë©´ì„œ êµ¬í˜„í•œ ë²„ì „ì´ TRPOë¼ê³  ìƒê°í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.</p>
<br>
<p>ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ëŒ€ë¶€ë¶„ function approximationì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë§¤ê°œë³€ìˆ˜í™”ëœ ì •ì±…ì„ ì°¾ëŠ” ìƒí™©ì„ ìƒê°í•˜ì. ê·¸ë¦¬ê³  ì•ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ í‘œê¸°ë¥¼ ë‹¨ìˆœíˆ í•  ê²ƒì´ë‹¤.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\eta(\theta) := \eta(\pi_{\theta})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(L_{\theta}(\tilde{\theta}):=L_{\pi_{\theta}}(\pi_{\tilde{\theta}})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(D_{\text{KL}}(\theta \Vert \tilde{\theta}) = D_{\text{KL}}(\pi_\theta \Vert \pi_{\tilde{\theta}})\)</span></p></li>
</ul>
<br>
<p>ì‹ <span class="math notranslate nohighlight">\((9)\)</span>ì˜ lower boundë¥¼ ìµœëŒ€í™”í•˜ê¸° ìœ„í•´ì„œëŠ”, ì²« ë²ˆì§¸ í…€ <span class="math notranslate nohighlight">\(L_{\pi}(\tilde{\pi})\)</span>ì€ ìµœëŒ€í•œ í¬ê²Œ, ë‘ ë²ˆì§¸ í…€ <span class="math notranslate nohighlight">\(C D_{\text{KL}}^{\text{max}}(\pi, \tilde{\pi})\)</span>ì€ ìµœëŒ€í•œ ì‘ê²Œ ë§Œë“¤ì–´ì£¼ë©´ ëœë‹¤ (ë‘ ë²ˆì§¸ í…€ì€ í•­ìƒ ì–‘ìˆ˜ì´ê¸° ë•Œë¬¸ì´ë‹¤). í•œí¸, ë‘ ë²ˆì§¸ í…€ì€ <span class="math notranslate nohighlight">\(\epsilon\)</span>ê³¼ KL ê±°ë¦¬ë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤. <span class="math notranslate nohighlight">\(\epsilon\)</span>ê³¼ KL ê±°ë¦¬ê°€ ì‘ìœ¼ë©´ ì‘ì„ìˆ˜ë¡ ë‘ ë²ˆì§¸ í…€ì´ ìµœì†Œê°€ ëœë‹¤. <span class="math notranslate nohighlight">\(\epsilon\)</span>ê³¼ KL ê±°ë¦¬ë¥¼ ìµœì†Œí™”ì‹œí‚¤ëŠ” ê²ƒì€ ì‰½ì§€ ì•Šì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ í˜„ì¬ ì •ì±…ê³¼ KL ê±°ë¦¬ê°€ ì‘ì€ ì •ì±…ì„ ì°¾ëŠ” ê²ƒì€ ë¹„êµì  ì‰¬ìš¸ ê²ƒì´ë‹¤. ë”°ë¼ì„œ TRPOì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìµœì í™” ë¬¸ì œë¥¼ ë³€í˜•í•´ì„œ ì‚¬ìš©í•œë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\operatorname*{maximize}\limits_{\theta}L_{\theta_{\text{old}}}(\theta) \\
\text{subject to } \; D_{\text{KL}}^{\text{max}}(\theta_{\text{old}}, \theta)\le \delta.
\end{matrix}  \quad \quad (11)
\end{split}\]</div>
<br>
<p><span class="math notranslate nohighlight">\(D_{\text{KL}}^{\text{max}}(\theta_{\text{old}}, \theta)\le \delta\)</span>ì¸ <span class="math notranslate nohighlight">\(\theta\)</span> ë“¤ì¤‘ì— <span class="math notranslate nohighlight">\(L_{\theta_{\text{old}}}(\theta)\)</span>ë¥¼ ê°€ì¥ í¬ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” <span class="math notranslate nohighlight">\(\theta\)</span>ë¥¼ ì°¾ëŠ” constrained optimizationì„ í‘¸ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ <span class="math notranslate nohighlight">\(D_{\text{KL}}^{\text{max}}\)</span>ì€ ê³„ì‚°í•˜ê¸° ë‚˜ì˜ë‹¤. ëª¨ë“  ìƒíƒœ <span class="math notranslate nohighlight">\(s\)</span>ì— ëŒ€í•´ì„œ KL ê±°ë¦¬ë¥¼ ê³„ì‚°í•´ì•¼ ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ í•œ ë²ˆ ë” ë‹¨ìˆœí™”í•˜ì—¬ í‰ê·  KL ê±°ë¦¬ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.</p>
<div class="math notranslate nohighlight">
\[
\overline{D}^{\rho}_{\text{KL}}(\theta_1, \theta_2)=\mathbb{E}_{s \sim \rho} \left[ D_{\text{KL}}(\pi_{\theta_1}(\cdot | s) \Vert \pi_{\theta_2}(\cdot | s))\right],
\]</div>
<p>ìœ„ ì •ì˜ì—ì„œ <span class="math notranslate nohighlight">\(\rho\)</span>ëŠ” ì„ì˜ì˜ ìƒíƒœë“¤ì— ëŒ€í•œ í™•ë¥ ë¶„í¬ì¸ë°, ì•ìœ¼ë¡œëŠ” ì­‰ <span class="math notranslate nohighlight">\(d_{\theta_{\text{old}}}\)</span>ë¥¼ ëŒ€ì…í•˜ê²Œ ëœë‹¤.</p>
<br>
<p>Max ëŒ€ì‹  ê¸°ëŒ“ê°’ì„ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ ì ì€ ì‹¤ì œ ê¸°ëŒ“ê°’ì„ ê³„ì‚°í•˜ëŠ” ëŒ€ì‹  ê²½í—˜ ë°ì´í„°ë¡œë¶€í„° í‘œë³¸í‰ê·  êµ¬í•´ì„œ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. ë”°ë¼ì„œ ìƒˆë¡œìš´ ìµœì í™” ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\operatorname*{maximize}\limits_{\theta}L_{\theta_{\text{old}}}(\theta) \\
\text{subject to } \; \overline{D}^{d_{\theta_{\text{old}}}}_{\text{KL}}(\theta_{\text{old}}, \theta)\le \delta.
\end{matrix}  \quad \quad (12)
\end{split}\]</div>
<br>
</section>
<hr class="docutils" />
<section id="sample-based-estimation-of-the-objective-and-constraint">
<h2><span class="section-number">14.4. </span>Sample-based Estimation of the Objective and Constraint<a class="headerlink" href="#sample-based-estimation-of-the-objective-and-constraint" title="Permalink to this headline">#</a></h2>
<p>ì—´ì‹¬íˆ ë‹¬ë ¤ì™”ì§€ë§Œ, ì‹ <span class="math notranslate nohighlight">\((12)\)</span>ë¥¼ ì—¬ì „íˆ êµ¬í˜„í•˜ê¸° ì–´ë ¤ìš¸ ê²ƒ ê°™ë‹¤. ì´ë²ˆ ì„¹ì…˜ì—ì„œëŠ” TRPOê°€ ì‹¤ì œ êµ¬í˜„ì„ ìœ„í•´ ì‹ <span class="math notranslate nohighlight">\((12)\)</span>ë¥¼ ì–´ë–»ê²Œ ë°”ê¾¸ëŠ”ì§€ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³¼ ê²ƒì´ë‹¤. ë¨¼ì € ì‹ <span class="math notranslate nohighlight">\((3)\)</span>ì„ ê°€ì ¸ì™€ì„œ ì‹ <span class="math notranslate nohighlight">\((12)\)</span>ì— ëŒ€ì…í•´ë³´ì</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\operatorname*{maximize}\limits_{\theta}\sum\limits_{s}d_{\theta_{\text{old}}}(s)\sum\limits_{a}\pi_{\theta}(a|s) A_{\theta_{\text{old}}}(s, a). \\
\text{subject to } \; \overline{D}^{d_{\theta_{\text{old}}}}_{\text{KL}}(\theta_{\text{old}}, \theta)\le \delta.
\end{matrix}  \quad \quad (13)
\end{split}\]</div>
<br>
<p>ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ìµœì í™” ëŒ€ìƒì„ ì§ì ‘ ê³„ì‚° ì–´ë µê¸° ë•Œë¬¸ì— ë°ì´í„°ë¡œë¶€í„° ì¶”ì •ì„ í•˜ëŠ” ë°©ì‹ì„ ë§ì´ íƒí•œë‹¤.  <span class="math notranslate nohighlight">\(\sum\limits_{s}d_{\theta_{\text{old}}}(s)\)</span>ëŠ” ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” <span class="math notranslate nohighlight">\(\pi_{\theta_{\text{old}}}\)</span> ë”°ë¼ì„œ ì—í”¼ì†Œë“œë¥¼ ì§„í–‰í•˜ì—¬ <span class="math notranslate nohighlight">\(s\)</span>ë¥¼ ì–»ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰ëœë‹¤. ì¦‰, <span class="math notranslate nohighlight">\(\mathbb{E}_{s \sim d_{\theta_{old}}}[\cdots]\)</span>ì´ ëœë‹¤.</p>
<br>
<p>ë‹¤ìŒìœ¼ë¡œ  <span class="math notranslate nohighlight">\(\sum\limits_{a}\pi_{\theta}(a|s) A_{\theta_{\text{old}}}(s, a)\)</span> ë¶€ë¶„ì´ë‹¤. ë¨¼ì € <span class="math notranslate nohighlight">\(A_{\theta_{\text{old}}}\)</span> ëŒ€ì‹  <span class="math notranslate nohighlight">\(Q_{\theta_{\text{old}}}\)</span>ë¥¼ ì‚¬ìš©í–ˆë‹¤ê³  í•œë‹¤. ì´ìœ ëŠ” ë”°ë¡œ ë‚˜ì™€ìˆì§€ ì•Šì§€ë§Œ, on-policy ì•Œê³ ë¦¬ì¦˜ë“¤ì—ì„œ <span class="math notranslate nohighlight">\(Q\)</span> í•¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ì‹ë“¤ì´ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì˜ˆë¥¼ ë“¤ë©´ REINFORCEì—ì„œëŠ” return <span class="math notranslate nohighlight">\(G_t\)</span>ë¥¼ <span class="math notranslate nohighlight">\(Q\)</span> í•¨ìˆ˜ì˜ ì¶”ì •ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. ë°˜ë©´, advantage functionì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒíƒœê°€ì¹˜í•¨ìˆ˜ë¥¼ ëª¨ë¸ë§í•´ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— í–‰ë™ê°€ì¹˜í•¨ìˆ˜ë¡œ ë°”ê¿”ì¤€ ê²ƒ ê°™ë‹¤.</p>
<br>
<p>ë‹¤ìŒìœ¼ë¡œ <span class="math notranslate nohighlight">\(\sum\limits_{a}\pi_{\theta}(a|s)\)</span>ì„ ìœ„í•´ì„œëŠ” importance samplingì„ í•´ì¤¬ë‹¤ê³  í•œë‹¤. í–‰ë™ê³µê°„ì´ êµ‰ì¥íˆ í¬ê±°ë‚˜ ì—°ì†ì ì´ë©´ ëª¨ë“  <span class="math notranslate nohighlight">\(a\)</span>ì— ëŒ€í•´ì„œ summationì„ í•´ì£¼ê¸° ì–´ë ¤ìš¸ ê²ƒì´ë‹¤. ë”°ë¼ì„œ, ìš°ë¦¬ê°€ ê°–ê³  ìˆëŠ” ë°ì´í„°ë¡œë¶€í„° ê³„ì‚°ì„ í•´ì¤˜ì•¼í• í…ë°, ìš°ë¦¬ê°€ ê°–ê³  ìˆëŠ” ë°ì´í„°ëŠ” <span class="math notranslate nohighlight">\(\pi_{\theta_{\text{old}}}\)</span> ë˜ëŠ” ì´ì „ ì •ì±…ë“¤ë¡œë¶€í„° ë§Œë“¤ì–´ì§„ ê²ƒì´ë‹¤. ì´ëŸ° ë°ì´í„° í¸í–¥ì„ ê³ ë ¤í•´ì¤„ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ importance samplingì´ë‹¤.</p>
<br>
<p>ìœ„ ì„¸ ë¬¸ë‹¨ì„ ë°˜ì˜í•˜ì—¬ TRPOì˜ ìµœì í™”ì‹ì„ ì ì–´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
\operatorname*{maximize}\limits_{\theta}\mathbb{E}_{s\sim d_{\theta_{\text{old}}}, a \sim q} \left[ \frac{\pi_{\theta}(a|s)}{q(a|s)} Q_{\theta_{\text{old}}}(s, a) \right]. \\
\text{subject to } \; 
\mathbb{E}_{s\sim d_{\theta_{\text{old}}}}\left[D_{\text{KL}}\left( \pi_{\theta_{\text{old}}}(\cdot|s) \Vert \pi_{\theta}(\cdot|s) \right) \right]
\le \delta.
\end{matrix}  \quad \quad (14)
\end{split}\]</div>
<br>
<p>ì´ë•Œ, <span class="math notranslate nohighlight">\(q\)</span>ëŠ” importance samplingì„ í•  ë•Œ ë°ì´í„°ë¥¼ ë½‘ëŠ” ì •ì±…ì´ë‹¤. íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë™ì•ˆ <span class="math notranslate nohighlight">\(q\)</span>ëŠ” ì—…ë°ì´íŠ¸ ë°”ë¡œ ì§ì „ ì •ì±…ì¸ <span class="math notranslate nohighlight">\(\pi_{\theta_{\text{old}}}\)</span>ê°€ ëœë‹¤. ì—¬ì „íˆ ê¸°ëŒ“ê°’ìœ¼ë¡œ ë‚˜ì™€ ìˆì–´ì„œ ì–´ë ¤ì›Œë³´ì¸ë‹¤. í•˜ì§€ë§Œ ê¸°ëŒ“ê°’ì€ í˜„ì¬ ì •ì±…ìœ¼ë¡œ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ì—¬ ê²½í—˜ ë°ì´í„°ë¥¼ ì–»ê³ , ì´ë¥¼ ëŒ€ì…í•˜ì—¬ í‘œë³¸í‰ê· ì„ ê³„ì‚°í•˜ì—¬ ì¶”ì •í•˜ê²Œ ëœë‹¤.</p>
<br>
</section>
<hr class="docutils" />
<section id="experiments">
<h2><span class="section-number">14.5. </span>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">#</a></h2>
<p>ë‹¤ìŒìœ¼ë¡œ TRPO ë…¼ë¬¸ì—ì„œ ë‚˜ì™€ ìˆëŠ” ì‹¤í—˜ ê²°ê³¼ë“¤ì„ ê°„ëµí•˜ê²Œ ì†Œê°œí•˜ë„ë¡ í•˜ê² ë‹¤. Cart Pole, Swimmer, Walker, Hopperì— ëŒ€í•œ ì‹¤í—˜ ê²°ê³¼ ê·¸ë˜í”„ì´ë‹¤. ì—¬ê¸°ì„œ Vine (íŒŒë€ìƒ‰ ì‹¤ì„ )ê³¼ Single Path (ì´ˆë¡ìƒ‰ ì‹¤ì„ )ì´ TRPO ì•Œê³ ë¦¬ì¦˜ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì°¸ê³ ë¡œ vineê³¼ single pathëŠ” ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” ìƒ˜í”Œë§ ê¸°ë²•ì´ë‹¤. Single pathê°€ í”íˆ ì•„ëŠ” ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œì„œ, í™˜ê²½ê³¼ í•˜ë‚˜ì˜ ì—í”¼ì†Œë“œ ë™ì•ˆ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/ret1.png"><img alt="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/ret1.png" src="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/ret1.png" style="width: 500px;" /></a>
</figure>
<br>
<p>Atariì— ëŒ€í•œ ì‹¤í—˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<p><img alt="png" src="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2022-9-18-trpo/ret2.png" />
<br></p>
<br>
<hr class="docutils" />
<p>ë‹¤ìŒ ì¥ì—ì„œëŠ” TRPOë¥¼ ì§ì ‘ êµ¬í˜„í•´ë³´ë„ë¡ í•  ê²ƒì´ë‹¤.</p>
<br>
<script
   type="text/javascript"
   src="https://utteranc.es/client.js"
   async="async"
   repo="HiddenBeginner/Deep-Reinforcement-Learnings"
   issue-term="pathname"
   theme="github-light"
   label="ğŸ’¬ comment"
   crossorigin="anonymous"
/></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/Chapter2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="8-gae.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">13. </span>Generalized Advantage Estimation (GAE)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="10-implementation-trpo.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>TRPO êµ¬í˜„</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ì¬ì•¼ì˜ ìˆ¨ì€ ì´ˆë³´<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>